# 第四章: 聚类算法
- 聚类概念: 对数据对象进行分组，将相似的对象划分到同一组或者类别中
- 区别分类: 聚类产生类别标签是未知的
## 距离度量

- 距离函数:  
    定义: d(x,y)  
    准则:  
    &emsp;(1) $d(x,x) = 0$ :与自身距离为零</br>
    &emsp;(2) $d(x,y) \geq 0 $ :距离是一个非负值</br>
    &emsp;(3) $d(x,y) = d(y,x)$ :距离函数有对称性</br>
    &emsp;(4) $d(x,y) \leq d(x,k) + d(k,y)$ :距离函数满足三角不等式</br>

1. **幂距离**:  
    $$d(R_i,R_j) = \sqrt[r]{\sum\limits_{k=1}^n(|R_{ik} - R_{jk}|)^p}$$
    解释: p, r为自定义参数, p:控制各维的渐进权重, r:控制对象间较大差值的渐进权重  
    特点: 幂距离没有考虑维度之间的关系, 不同维度对距离的贡献  
    引申: 根据r, p 参数不同  
    &emsp;(1) **欧式距离**: $r = p = 2$ </br>
    &emsp;(2) **曼哈顿距离**: $r = p = 1$ </br>
    &emsp;(3) **切比雪夫距离**: $r = p = +\infty$ </br>

2. **余弦相似度**:  
    $$d(R_i,R_j) = cos(\vec{R_i},\vec{R_j}) = \frac{\sum\limits_{k=1}^{n} R_{ik}R_{jk}}{\sqrt{\sum\limits_{k=1}^{n}R_{ik}^{2}}\sqrt{\sum\limits_{k=1}^{n}R_{jk}^{2}}}$$  
    解释: 用向量空间中两个向量夹角余弦值衡量两个个体间差异  
    特点: 对数值不敏感, 注重方向上差异 (方向相同, 相似度为 1 ; 方向相反, 相似度为 -1)  
 
3. **兰氏距离**:  
    优点: 受异常值影响较小, 适合有高度偏倚的数据  
    缺点: 没有考虑维度间相关性  

4. **马氏距离**:  
    优点: 考虑了维度间的相关性(样本数>维数)  
    缺点: 计算复杂
5. 汉明距离
6. 斜交空间距离
7. 杰卡德距离

## 一，基于划分聚类
- 概念: 构建数据的k个划分, 每个划分表示一个聚类  
- 方法: 先创建一个初始划分, 然后迭代重定位, 不断改进划分质量, 试图达到全局最优  


1. **K均值算法**:  
    方法: 选k个点为初始聚类中心, 把对象按距中心距离归类, 计算新聚类中心, 直至相邻两次计算的新聚类中心未改变  
    缺点:   
    &emsp;(1) k值为事先给定, 难以估计</br>
    &emsp;(2) 由于初始聚类中心的随机选取,容易陷入局部最优</br>
    &emsp;(3) 当数据量较大时, 算法的时间开销也将非常大</br>

2. **K均值++算法**:  
    方法: 对K均值改进, 选择新聚类中心时, 距现聚类中心越远, 选中概率越大  

3. **二分K均值算法**:  
    方法: 对K均值改进, 通过二分减少相似度计算, 加快算法执行速度, 降低初始化问题影响

4. 小批量K均值算法

## 二，基于层次聚类
- 凝聚(自下而上): 每一个点作为一个簇, 每一步合并两个最接近的簇, 直至只有一个簇
- 分裂(自上而下): 所有点为一个簇开始, 每一步分裂一个簇, 直至只剩下单点簇

1. **最短距离法**:  
    距离定义: 不同簇两个最近点之间的距离  
2. **最长距离法**:  
    距离定义: 不同簇两个最远点之间的距离
3. **中间距离法**:  
    距离定义: 与最短距离点和最长距离点连线中点的距离
4. **重心法**:  
    距离定义: 用簇之间的重心表示
5. **类平均法**:  
    距离定义: 两簇间点与点间的平均平方距离

- **层次聚类性质**:
1. 单调性: 先合并的簇相似性高于后合并的簇
2. 空间的浓缩与扩张: 最短距离法, 重心法使空间浓缩; 最长距离法使空间扩张; 类平均法较为适中


## 三，基于密度聚类
- 起源: 对基于划分聚类偏向发现球状聚类的问题改进  
- 方法: 邻近区域密度大于一定阈值就持续聚类, 可以过滤噪声, 发现任意形状的聚类  

1. **DBSCAN算法**:  
    核心思想: 基于任意高密度区域扩展聚类
2. **OPTICS算法**:  
    核心思想: 增加"核心距离"和"可达距离"用于衡量密度高低

## 四，基于模型聚类
- 思想: 假定数据有一个内在的混合概率分布, 寻找最佳拟合模型

## 五，基于网格聚类
- 思想: 基于空间划分有限单元网格, 根据网格数据结构聚类

## 聚类算法评价

1. 调整兰德指数: 衡量数据分布的吻合情况
2. 互信息评分: 衡量实际类别与预测类别吻合情况
3. 同质性: 每个结果簇只包含单个类
4. 完整性: 单个类都被归到一个簇中
5. 调和平均: 
6. 轮廓系数
7. Fowlkes-Mallows评分
8. Calinski-Harabz指数